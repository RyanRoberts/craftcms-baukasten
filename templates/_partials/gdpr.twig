<style>
  {{ craft.twigpack.includeFile("@webroot/dist/css/orejime.css") }}
</style>

<script>
  {{ craft.twigpack.includeFile("@webroot/dist/js/orejime.js") }}
</script>

{# If you like IE11 support #}
{# <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> #}

<script>
  var orejimeCallback = function (state, app) {
    console.log("User consent for app " + app.name + ": consent=" + state);
  };

  var orejimeConfig = {
    elementID: "orejime",
    cookieName: "orejime",
    cookieExpiresAfterDays: 365,
    stringifyCookie: (contents) => JSON.stringify(contents),
    parseCookie: (cookie) => JSON.parse(cookie),
    privacyPolicy: "{{ siteUrl }}",
    default: true,
    mustConsent: false,
    mustNotice: false,
    implicitConsent: false,
    lang: "en",
    logo: false,
    debug: false,
    translations: {
      en: {
        consentModal:
          {
            title: 'Information that we collect',
            description: 'Here you can see and customize the information that we collect about you.',
            privacyPolicy:
              {
                name: 'privacy policy',
                text: 'To learn more, please read our {privacyPolicy}.'
              }
          },
        consentNotice: {
          changeDescription: 'There were changes since your last visit, please update your consent.',
          description: 'We collect and process your personal information for the following purposes: {purposes}.',
          learnMore: 'Learn more'
        },
        accept: 'Accept',
        acceptAll: 'Accept all apps',
        save: 'Save',
        saveData: 'Save my configuration on collected information',
        decline: 'Decline',
        declineAll: 'Decline all apps',
        close: 'Close',
        enabled: 'Enabled',
        disabled: 'Disabled',
        app: {
          optOut: {
            title: '(opt-out)',
            description: 'This app is loaded by default (but you can opt out)',
          },
          required: {
            title: '(always required)',
            description: 'This application is always required',
          },
          purposes: 'Purposes',
          purpose: 'Purpose'
        },
        poweredBy: 'Powered by Orejime',
        newWindow: 'new window',

        purposes: {
          necessary: 'Necessary',
          statistics: 'Statistics',
          richMedia: 'Rich Media',
          advertisement: 'Advertisement',
        },
        craftCMS: {
          description: 'Necessary cookies to run this website.'
        },
        googleAnalytics: {
          description: 'Google Analytics is used to have a better understanding what our user want.'
        }
      },
    },

    // The list of third-party apps that Orejime will manage for you.
    // The apps will appear in the modal in the same order as defined here.
    apps: [
      {
        name: 'craftCMS',
        title: 'Craft CMS',
        default: 1,
        required: 1,
        purposes: ['necessary'],
        callback: orejimeCallback,
      },
      {
        name: 'youtube',
        title: 'Youtube',
        default: 1,
        required: 0,
        purposes: ['richMedia'],
        callback: orejimeCallback,
      },
      {
        name: 'googleAnalytics',
        title: 'Google Analytics',
        default: 1,
        required: 0,
        cookies: [
          "_ga",
          "_gat",
          "_gid",
          "__utma",
          "__utmb",
          "__utmc",
          "__utmt",
          "__utmz",
          "_gat_gtag_" + (window.GTM_UA ? window.GTM_UA : ''),
          "_gat_" + (window.GTM_UA ? window.GTM_UA : ''),
        ],
        purposes: ['statistics'],
        callback: function (state, app) {
          // More info how to use it with GTM:
          // https://www.powerflash.at/blog/consent-tool-klaro-google-tagmanager/?ref=bestwebsite.gallery
          // if (state !== false) {
          //   dataLayer.push({'event': 'loadgtm-analytics'})
          // }
        }
      }
    ]
  }


  window.addEventListener('load', function () {
    var buttons = [...document.querySelectorAll('.orejime-Button--save')];
    if (buttons) {
      buttons.forEach(function (button) {
        button.addEventListener('click', function () {
          console.log('clicked');
          location.reload();
        })
      })
    }
  })

</script>

