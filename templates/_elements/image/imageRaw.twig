{# Set Defaults #}
{% set defaults = {
  cn: 'c-imageRaw',
  modifiers: [],
  customClasses: [],
  data: {},
  js: null,
  image: null,
  transform: null | default('landscape'),
  objectFit: null,
  lazy: true,
} %}

{# Merge Default with Options #}
{% set props = props is defined ? defaults|merge(props) : defaults %}

{# Macros #}
{% import '_macros/_macro-settings.twig' as module %}

{# Image #}
{% if props.image ??? null %}
  {% set image = props.image %}
{% endif %}

{% if image ??? null %}
  {# Skip Transforms for the current filetypes #}
  {% set skipTransformsForThisExtensions = ['gif', 'GIF', 'tiff', 'TIFF', 'svg', 'SVG'] %}

  {% if image is iterable %}
    {% set extension = image.extension %}
  {% else %}
    {% set extension = image | split('.') | last %}
  {% endif %}

  {% if image.extension not in skipTransformsForThisExtensions %}

    {# Final Image Set #}
    {% set transformedImages = craft.imager.transformImage(image, props.transform) %}

    {# Placeholder #}
    {% set placeholderImage = craft.imager.placeholder({
      width: transformedImages|first.width,
      height: transformedImages|first.height
    }) %}
  {% endif %}

  {% if image.extension not in skipTransformsForThisExtensions %}
    {# Transforming #}
    {% include '_elements/image/_transforming.twig' %}
  {% else %}
    {# No Transforming #}
    {% include '_elements/image/_no-transforming.twig' %}
  {% endif %}
  <noscript><img src="{{ image.getUrl() }}" alt="{{ image.title }}"></noscript>
{% endif %}
