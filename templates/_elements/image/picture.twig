{# Set Defaults #}
{% set defaults = {
  cn: 'c-picture',
  modifiers: [],
  customClasses: [],
  data: {},
  js: null,
  image: null,
  transform: null | default('landscape'),
  showDominantColor: true,
  dominantColor: null,
  calcDominantColor: false,
  objectFit: null,
  lazy: true,
  noscript: true
} %}


{# Merge Default with Options #}
{% set props = props is defined ? defaults|merge(props) : defaults %}

{# Macros #}
{% import '_macros/_macro-settings.twig' as module %}
{% import '_macros/_macro-imageHelper.twig' as imageHelper %}

{# Image #}
{% if props.image ??? null %}
  {% set image = props.image %}
{% endif %}

{% if image ??? null %}
  <picture {{ module.settings(props) }}  {% if props.showDominantColor %}style="background-color: {{- imageHelper.getDominantColor(image, props.calcDominantColor) -}}; "{% endif %}>
    {{- imageHelper.renderSource(image, props.transform) -}}
    {{- imageHelper.renderImage(image, props.transform, props.lazy, props.objectFit, props.calcDominantColor) -}}
    {% if props.noscript %}
      {{- imageHelper.renderNoScript(image) -}}
    {% endif %}
  </picture>
{% endif %}
