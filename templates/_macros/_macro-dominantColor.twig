{% macro dominantColor(image) %}
  {% set defaults = {
    ratio: 1/1,
    position: '50% 50%',
  } %}

  {% set props = props is defined ? defaults|merge(props) : defaults %}

  {% if image.settingsDominantColorOverwrite ?? null %}
    {% set dominantColor = image.settingsDominantColorOverwrite %}
  {% elseif image.pluginPreparseDominantColor ?? null %}
    {% set dominantColor = image.pluginPreparseDominantColor %}
  {% else %}
    {% set dominantImages = craft.imager.transformImage(image, [{ width: 100 }], {
      ratio: props.ratio,
      position: props.position,
      jpegQuality: 50
    }) %}
    {% set dominantColor = craft.imager.getDominantColor(dominantImages | last, 10) %}
  {% endif %}

  {{- ' background-color: ' ~ dominantColor ~ ';' -}}
{% endmacro %}
